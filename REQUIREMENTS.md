# 体卫艺办公助手 - 需求文档 (REQUIREMENTS.md)

## 1. 项目概述
本项目是一个基于 Streamlit 的办公辅助工具，旨在提高龙华区教育局体卫艺科室的办公效率。主要包含**政务活动申报自动生成**和**学校通讯录查询**两大核心功能。

## 2. 核心功能模块

### 模块一：领导公务单自动生成器 (Core Feature)
**目标**：将用户的大白话描述自动转化为规范的政务公文语言，并生成标准的 Word 申报单。

#### 2.1 交互流程（两步生成法）
1.  **输入与润色阶段**
    *   **输入**：用户在文本框输入活动的非正式描述（大白话）。
    *   **操作**：点击“✨ 立即智能填表并生成 Word”按钮（绿色高亮）。
    *   **处理**：AI 仅对输入内容进行**动宾结构**和**语序**的规范化润色，**严禁无中生有**（不杜撰时间、地点、人物）。
    *   **输出**：展示润色后的文本供用户确认。

2.  **确认与生成阶段**
    *   **确认**：用户查看润色后的文本。
        *   提供“⬅️ 返回修改”按钮，返回上一步。
        *   提供“✨ 确认无误，生成申报单信息”按钮，进入下一步。
    *   **解析**：AI 自动从确认的文本中提取关键字段（见 2.3 数据字典）。
    *   **预览与编辑**：展示所有解析出的字段，允许用户进行二次编辑和微调。
    *   **导出**：用户点击“💾 导出正式 Word 文档”按钮，下载生成的 `.docx` 文件。

#### 2.2 界面展示要素
*   **申报部门**：固定显示“体卫艺劳科”。
*   **填写说明**：底部注明“此表请于政务活动前一周星期四下班前交办公室登记汇总”。
*   **时间调整**：显示“时间可否调整：☑否”（目前仅作展示）。

#### 2.3 数据字典 (Word 模板字段)
| 字段名 | 描述 | 来源 |
| :--- | :--- | :--- |
| `title` | 政务活动名称 | AI 提取 |
| `content` | 申请理由、背景 | AI 提取 (转化为“为落实...要求，推进...发展”) |
| `agenda` | 详细议程 | AI 提取 (按顺序列出，禁止杜撰具体时间点) |
| `time` | 活动日期/时间 | AI 提取 |
| `duration` | 会议时长 | AI 提取 (默认“1小时”) |
| `place` | 地点 | AI 提取 |
| `num` | 预计人数 | AI 提取 |
| `contact` | 公务对接人 | AI 提取 (默认“孙沛”) |
| `projector` | 投影仪是否使用 | AI 提取 ("☑是"/"☐否") |
| `dist_leader` | 拟请出席的区领导 | AI 提取 (新增) |
| `bur_leader` | 拟请局领导 | AI 提取 (新增) |
| `others` | 建议参加单位(部门) | AI 提取 (新增) |

---

### 模块二：龙华学校查号台
**目标**：提供安全便捷的全区学校通讯录查询功能。

#### 2.1 访问控制
*   **安全验证**：首次进入需输入授权密码（预设：`lhjy`）。
*   **提示**：未验证时显示“🔒 为了数据安全，访问通讯录需要授权”。

#### 2.2 查询功能
*   **数据源**：加载本地 `龙华中小学校通讯录（含幼儿园）.csv` 文件（支持 utf-8-sig 和 gbk 编码）。
*   **搜索**：支持按“学校名”或“人名”关键词模糊搜索。
*   **结果展示**：实时显示匹配的通讯录条目。

## 3. UI/UX 设计规范 (Mobile First)

### 3.1 移动端适配
*   **布局模式**：`layout="centered"`，在手机端保持良好的阅读体验。
*   **字体优化**：
    *   正文字体：14px
    *   标题字体：h1 (1.5rem), h2 (1.25rem)
    *   输入框/按钮：适当缩减内边距和字体大小，增加屏幕信息密度。
*   **布局调整**：
    *   隐藏 Streamlit 默认的 Header（右上角汉堡菜单在 PC 端隐藏，**移动端保留**以保证侧边栏可访问）。
    *   隐藏 Footer。
    *   侧边栏在移动端默认收起，通过左上角图标唤出。

### 3.2 视觉风格
*   **配色**：
    *   主色调：绿色（Primary Button），代表“通过”、“执行”。
    *   辅助色：默认 Streamlit 风格。
*   **提示与引导**：
    *   顶部添加黄色警告条（`st.warning`）：提示用户“👆 点击左上角 >> 可切换到「查号台」”，辅助老年用户导航。
    *   使用 `st.expander` 折叠详细的“使用指南”，保持界面整洁。

## 4. 技术栈
*   **框架**：Python + Streamlit
*   **AI 模型**：OpenAI SDK 兼容接口 (DeepSeek-V3)
*   **文档处理**：`docxtpl` (Word 模板渲染)
*   **数据处理**：`pandas`

## 5. 项目文件结构
*   `app.py`: 主程序入口。
*   `requirements.txt`: 项目依赖。
*   `申报单模板.docx`: Word 模板文件。
*   `龙华中小学校通讯录（含幼儿园）.csv`: 通讯录数据源。
